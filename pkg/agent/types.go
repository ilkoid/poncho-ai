// Package agent определяет интерфейс AI-агента для обработки запросов.
//
// Пакет содержит только интерфейс без импорта internal/ для избежания
// циклических зависимостей. Конкретные реализации находятся в internal/agent.
package agent

import (
	"context"

	"github.com/ilkoid/poncho-ai/pkg/llm"
)

// Agent представляет интерфейс AI-агента для обработки запросов пользователя.
//
// Используется в GlobalState (internal/app) для избежания циклической зависимости:
//   - internal/app импортирует pkg/agent (только интерфейс)
//   - internal/agent импортирует internal/app (конкретная реализация)
//
// Этот паттерн соответствует Dependency Inversion Principle:
// высокоуровневые модули зависят от абстракций, а не от конкретных реализаций.
type Agent interface {
	// Run выполняет обработку запроса пользователя.
	//
	// Принимает:
	//   - ctx: контекст для отмены операции
	//   - query: текстовый запрос пользователя
	//
	// Возвращает:
	//   - string: финальный ответ агента
	//   - error: ошибка если не удалось выполнить запрос
	Run(ctx context.Context, query string) (string, error)

	// ClearHistory очищает историю диалога агента.
	//
	// Полезно для начала новой сессии или сброса контекста.
	ClearHistory()

	// GetHistory возвращает копию истории диалога агента.
	//
	// Включает все сообщения: пользовательские, ассистента и результаты tools.
	GetHistory() []llm.Message
}
