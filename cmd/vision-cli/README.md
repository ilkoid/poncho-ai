# Vision CLI

Standalone —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ Vision AI. –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–µ—à–Ω-—ç—Å–∫–∏–∑–æ–≤ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ä–∏—Å—É–Ω–∫–æ–≤ –∏–∑ S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- **–°—Ç—Ä–æ–≥–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ**: —É—Ç–∏–ª–∏—Ç–∞ –ø–∞–¥–∞–µ—Ç –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ config.yaml –∏–ª–∏ –ø—Ä–æ–º–ø—Ç–æ–≤
- **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**: –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É—é—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤ –≥–æ—Ä—É—Ç–∏–Ω–∞—Ö
- **S3 –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –∏–∑ S3 —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
- **Vision AI**: –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏

## –°–±–æ—Ä–∫–∞

```bash
cd cmd/vision-cli
go build -o vision-cli .
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```
vision-cli/
‚îú‚îÄ‚îÄ vision-cli          # –±–∏–Ω–∞—Ä–Ω–∏–∫
‚îú‚îÄ‚îÄ config.yaml          # –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îî‚îÄ‚îÄ prompts/             # –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è AI
    ‚îú‚îÄ‚îÄ agent_system.yaml
    ‚îú‚îÄ‚îÄ image_analysis.yaml
    ‚îî‚îÄ‚îÄ sketch_description_prompt.yaml
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã

- `config.yaml` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ —Ç–æ–π –∂–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —á—Ç–æ –∏ –±–∏–Ω–∞—Ä–Ω–∏–∫
- `prompts/` ‚Äî –ø–∞–ø–∫–∞ —Å –ø—Ä–æ–º–ø—Ç–∞–º–∏ —Ä—è–¥–æ–º —Å config.yaml
- –ü–æ—Å—Ç-–ø—Ä–æ–º–ø—Ç—ã —É–∫–∞–∑–∞–Ω–Ω—ã–µ –≤ config.yaml –¥–æ–ª–∂–Ω—ã —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
export ZAI_API_KEY="your-zai-api-key"
export S3_ACCESS_KEY="your-s3-access-key"
export S3_SECRET_KEY="your-s3-secret-key"
export WB_API_KEY="your-wb-api-key"  # –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

```bash
./vision-cli -query "–ø–æ–∫–∞–∂–∏ –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –≤ S3"
```

### –ê–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

```bash
./vision-cli -query "–∑–∞–≥—Ä—É–∑–∏ –∞—Ä—Ç–∏–∫—É–ª 12611516 –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —ç—Å–∫–∏–∑—ã"
```

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º

```bash
./vision-cli
Enter query: –∑–∞–≥—Ä—É–∑–∏ –∞—Ä—Ç–∏–∫—É–ª 12611516
```

### –°–≤–æ–π config

```bash
./vision-cli -config /path/to/config.yaml -query "..."
```

## –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

| Tool | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `list_s3_files` | –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ –≤ S3 –ø–æ –ø—Ä–µ—Ñ–∏–∫—Å—É |
| `read_s3_object` | –ß—Ç–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ S3 |
| `read_s3_image` | –ß—Ç–µ–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å —Ä–µ—Å–∞–π–∑–æ–º –≤ Base64 |
| `classify_and_download_s3_files` | –ó–∞–≥—Ä—É–∑–∫–∞ –∞—Ä—Ç–∏–∫—É–ª–∞ —Å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–µ–π –ø–æ —Ç–µ–≥–∞–º |
| `analyze_article_images_batch` | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —á–µ—Ä–µ–∑ Vision AI |
| `plan_*` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–º –∑–∞–¥–∞—á |

## –ü—Ä–∏–º–µ—Ä—ã –æ—Ç–≤–µ—Ç–æ–≤

### –°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤

```
## üìÅ –ê—Ä—Ç–∏–∫—É–ª 12611516
- **12611516.json** (68.3 KB)
- **Detailed_color_sketch.png** (979.3 KB)
- **Main_view_sketch_front.png** (4.2 MB)
...
```

### –ê–Ω–∞–ª–∏–∑ —ç—Å–∫–∏–∑–∞

```json
{
  "—Ç–∏–ø_–∏–∑–¥–µ–ª–∏—è": "–∂–∞–∫–µ—Ç",
  "—Å–∏–ª—É—ç—Ç": "–ø—Ä—è–º–æ–π —Å–≤–æ–±–æ–¥–Ω—ã–π",
  "–¥–µ—Ç–∞–ª–∏": "–≤–æ—Ä–æ—Ç–Ω–∏–∫ —Å –∑–∞—Å—Ç–µ–∂–∫–æ–π, –ø–µ—Ä–µ–¥–Ω—è—è –ø–ª–∞–Ω–∫–∞...",
  "—Ü–≤–µ—Ç": "—Å–∏–Ω–∏–π/—á–µ—Ä–Ω—ã–π —Å –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º –ø—Ä–∏–Ω—Ç–æ–º",
  "—Ç–∫–∞–Ω–∏": "–¥–∂–∏–Ω—Å–æ–≤–∞—è —Ç–∫–∞–Ω—å"
}
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–£—Ç–∏–ª–∏—Ç–∞ –ø–∞–¥–∞–µ—Ç —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ –æ—à–∏–±–∫–∞–º–∏:

```
# –ù–µ—Ç config.yaml
Initialization failed: config.yaml not found

# –ù–µ—Ç prompts/
Initialization failed: prompts directory not found

# –ù–µ—Ç –ø–æ—Å—Ç-–ø—Ä–æ–º–ø—Ç–∞
Initialization failed: tool prompts validation failed:
  - tool 'analyze_article_images_batch': sketch_description_prompt.yaml
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ —Å–µ–∫—Ü–∏–∏ `config.yaml`:

```yaml
models:
  default_chat: "glm-4.6"
  default_vision: "glm-4.6v"  # –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

s3:
  bucket: "plm-ai"
  endpoint: "storage.yandexcloud.net"

image_processing:
  max_width: 800  # —Ä–µ—Å–∞–π–∑ –ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π –≤ Vision API
  quality: 90

tools:
  analyze_article_images_batch:
    enabled: true
    post_prompt: "sketch_description_prompt.yaml"
```

## –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ

–î–ª—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è —É—Ç–∏–ª–∏—Ç—ã:

```bash
# –°–æ–±—Ä–∞—Ç—å –±–∏–Ω–∞—Ä–Ω–∏–∫
go build -o vision-cli .

# –£–ø–∞–∫–æ–≤–∞—Ç—å —Å –∫–æ–Ω—Ñ–∏–≥–æ–º –∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏
tar czf vision-cli.tar.gz vision-cli config.yaml prompts/

# –ù–∞ —Ü–µ–ª–µ–≤–æ–π –º–∞—à–∏–Ω–µ
tar xzf vision-cli.tar.gz
export ZAI_API_KEY="..."
./vision-cli -query "..."
```
