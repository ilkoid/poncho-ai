# Todo Agent Configuration
# Local standalone configuration for cmd/todo-agent

# Models Configuration
models:
  default_reasoning: "GLM-4.5-Flash"
  default_chat: "GLM-4.5-Flash"
  default_vision: "GLM-4.6V-Flash"
  definitions:
    GLM-4.5-Flash:
      provider: "zai"
      model_name: "GLM-4.5-Flash"
      api_key: "${ZAI_API_KEY}"
      base_url: "https://api.z.ai/api/paas/v4"
      max_tokens: 2000
      temperature: 0.5
      timeout: "120s"
      thinking: "enabled"
      parallel_tool_calls: false
      is_vision: false
    GLM-4.6V-Flash:
      provider: "zai"
      model_name: "GLM-4.6V-Flash"
      api_key: "${ZAI_API_KEY}"
      base_url: "https://api.z.ai/api/paas/v4"
      max_tokens: 4000
      temperature: 0.1
      timeout: "120s"
      parallel_tool_calls: false
      is_vision: true

# S3 Configuration
s3:
  endpoint: "storage.yandexcloud.net"
  region: "ru-central1"
  bucket: "plm-ai"
  access_key: "${S3_ACCESS_KEY}"
  secret_key: "${S3_SECRET_KEY}"
  use_ssl: true

# Image Settings
image_processing:
  max_width: 800
  quality: 90

# App Settings
app:
  debug: true
  prompts_dir: "./prompts"
  streaming:
    enabled: true        # Default: true (opt-out). Streaming включен по умолчанию
    thinking_only: true  # Default: true. Отправлять только reasoning_content события
  debug_logs:
    enabled: true
    save_logs: true
    logs_dir: "./logs"
    include_tool_args: true
    include_tool_results: true
    max_result_size: 5000

# File Classification Rules
file_rules:
  - tag: "sketch"
    patterns: ["*.jpg", "*.jpeg", "*.png"]
    required: true
  - tag: "plm_data"
    patterns: ["*.json"]
    required: true

# Wildberries API Defaults
wb:
  api_key: "${WB_API_KEY}"
  base_url: "https://content-api.wildberries.ru"
  rate_limit: 100
  burst_limit: 5
  retry_attempts: 3
  timeout: "30s"

# Tools Configuration - 24 WORKING TOOLS (9 stubs excluded)
tools:
  # === WB Content API Tools ===
  get_wb_parent_categories:
    enabled: true
    description: "Возвращает список родительских категорий Wildberries"
    endpoint: "https://content-api.wildberries.ru"
    path: "/content/v2/object/parent/all"
    rate_limit: 100
    burst: 5

  get_wb_subjects:
    enabled: true
    description: "Возвращает список предметов для категории с пагинацией"
    endpoint: "https://content-api.wildberries.ru"
    path: "/content/v2/object/all"
    rate_limit: 100
    burst: 5

  get_wb_subjects_by_name:
    enabled: true
    description: "Ищет предметы по подстроке в названии"
    endpoint: "https://content-api.wildberries.ru"
    rate_limit: 100
    burst: 5

  get_wb_characteristics:
    enabled: true
    description: "Возвращает характеристики для предмета"
    endpoint: "https://content-api.wildberries.ru"
    rate_limit: 100
    burst: 5

  get_wb_tnved:
    enabled: true
    description: "Возвращает коды ТНВЭД для предмета"
    endpoint: "https://content-api.wildberries.ru"
    rate_limit: 100
    burst: 5

  get_wb_brands:
    enabled: true
    description: "Возвращает бренды для предмета"
    endpoint: "https://content-api.wildberries.ru"
    rate_limit: 100
    burst: 5

  ping_wb_api:
    enabled: true
    description: "Проверяет доступность Wildberries Content API"
    endpoint: "https://content-api.wildberries.ru"
    path: "/ping"
    rate_limit: 100
    burst: 5

  # === WB Dictionary Tools ===
  wb_colors:
    enabled: true
    description: "Ищет цвета в справочнике Wildberries"

  wb_countries:
    enabled: true
    description: "Возвращает справочник стран производства"

  wb_genders:
    enabled: true
    description: "Возвращает справочник значений пола"

  wb_seasons:
    enabled: true
    description: "Возвращает справочник сезонов"

  wb_vat_rates:
    enabled: true
    description: "Возвращает справочник ставок НДС"

  # === S3 Basic Tools ===
  list_s3_files:
    enabled: true
    description: "Возвращает список файлов в S3 по пути"

  read_s3_object:
    enabled: true
    description: "Читает содержимое  json-PLM файла из S3 с производственным описанием товара"
    post_prompt: "articles/json_analyzer.yaml"

  read_s3_image:
    enabled: true
    description: "Скачивает и оптимизирует изображение из S3"
    post_prompt: "articles/sketch_analyzer.yaml"

  get_plm_data:
    enabled: true
    description: "Загружает PLM данные (plm.json) артикула из S3 и возвращает очищенный JSON без технических полей, миниатюр и эскизов. Используй для получения информации о товаре: артикул, категория, сезон, цвета, материалы, размерный ряд."

  # === S3 Batch Tools ===
  classify_and_download_s3_files:
    enabled: true
    description: "Списывает и классифицирует файлы артикула из S3 по тегам (sketch, plm_data, marketing). JSON файлы скачивает сразу, изображения — только метаданные. Для vision-анализа используй read_s3_image."
    post_prompt: "articles/product_description.yaml"

  # === Planner Tools ===
  plan_add_task:
    enabled: true
    description: "Добавляет новую задачу в план"

  plan_mark_done:
    enabled: true
    description: "Отмечает задачу как выполненную"

  plan_mark_failed:
    enabled: true
    description: "Отмечает задачу как проваленную"

  plan_clear:
    enabled: true
    description: "Очищает весь план"

  plan_set_tasks:
    enabled: true
    description: "Создаёт или заменяет весь план задач"
