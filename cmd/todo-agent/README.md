# Todo Agent

TUI утилита для управления задачами через AI агента. Пользователь вводит запрос, агент создаёт план через todo tools и выполняет его с помощью всех доступных инструментов.

## Возможности

- **24 рабочих инструмента**:
  - S3: работа с файлами (list, read, read image)
  - WB Catalog: категории и предметы Wildberries
  - WB Characteristics: характеристики, ТНВЭД, бренды
  - WB Dictionary: справочники (цвета, страны, пол, сезоны, НДС)
  - Planner: управление задачами

- **TUI интерфейс**:
  - Todo List виджет (слева)
  - Tool execution trace (справа)
  - История сообщений
  - Поле ввода задач

- **JSON логирование**: все выполнения сохраняются в `logs/`

## Установка

### Требования

- Go 1.21+
- Переменные окружения:
  - `ZAI_API_KEY` - API ключ для LLM провайдера
  - `S3_ACCESS_KEY`, `S3_SECRET_KEY` - ключи для S3 хранилища
  - `WB_API_KEY` - API ключ для Wildberries (опционально)

### Сборка

```bash
cd cmd/todo-agent
go build -o todo-agent
```

## Использование

### Запуск

```bash
./todo-agent
```

### Горячие клавиши

- `Enter` - отправить задачу
- `Ctrl+C` - выход
- Стрелки - навигация по истории

### Примеры запросов

```
# Проверить доступность WB API
проверь доступность WB API

# Получить родительские категории
покажи родительские категории Wildberries

# Найти предметы в категории
найди предметы в категории ID 1541

# Список файлов в S3
покажи файлы в S3 по пути /articles/

# Комплексная задача
проверь доступность WB API, затем покажи родительские категории
```

## Структура

```
cmd/todo-agent/
├── main.go              # Точка входа
├── tui/
│   └── model.go         # TUI модель
├── config.yaml          # Конфигурация
├── prompts/
│   └── system.yaml      # Системный промпт
├── logs/                # JSON логи (создаются при работе)
└── README.md            # Этот файл
```

## Конфигурация

Файл `config.yaml` содержит:

- Настройки моделей (glm-4.6)
- S3 подключение
- Wildberries API
- Включенные инструменты (все 24 рабочих)

## Логирование

Все выполнения агента сохраняются в `logs/debug_TIMESTAMP.json`:

```json
{
  "run_id": "debug_20260110_150405",
  "user_query": "проверь доступность WB API",
  "iterations": [...],
  "summary": {
    "total_llm_calls": 2,
    "total_tools_executed": 1,
    "visited_tools": ["ping_wb_api"]
  }
}
```

## Архитектура

Утилита использует:

- `pkg/agent` - фасад для AI агента
- `pkg/events` - Port & Adapter для событий
- `pkg/debug` - JSON логирование
- `pkg/tui` - хелперы для Bubble Tea

**Rule 6 compliant**: только переиспользование кода из `pkg/`, нет зависимостей от `internal/`.
