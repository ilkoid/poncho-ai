# E-commerce Product Analyzer Configuration
# Практический пример использования Poncho AI с реальными данными

models:
  default_reasoning: "glm-4.6"
  default_chat: "glm-4.6"
  default_vision: "glm-4.6v-flash"

  definitions:
    glm-4.6:
      provider: "zai"
      model_name: "glm-4.6"
      api_key: "${ZAI_API_KEY}"
      base_url: "https://api.z.ai/api/paas/v4"
      max_tokens: 4000
      temperature: 0.5
      timeout: "120s"
      thinking: "enabled"
      parallel_tool_calls: false
      is_vision: false

    glm-4.6v-flash:
      provider: "zai"
      model_name: "glm-4.6v-flash"
      api_key: "${ZAI_API_KEY}"
      base_url: "https://api.z.ai/api/paas/v4"
      max_tokens: 4000
      temperature: 0.1
      timeout: "120s"
      parallel_tool_calls: false
      is_vision: true

app:
  debug: false
  prompts_dir: "./prompts"

  streaming:
    enabled: true
    thinking_only: true

  debug_logs:
    enabled: true
    save_logs: true
    logs_dir: "./debug_logs"
    include_tool_args: true
    include_tool_results: true
    max_result_size: 10000

# ===== PHASE 2: Tool Bundles =====
# Группируем инструменты по бизнес-контексту
tool_bundles:
  # Wildberries Content API — категории, бренды, товары
  wb-content-tools:
    description: "Wildberries Content API: parent categories, subjects, brands, products search"
    tools:
      - get_wb_parent_categories
      - get_wb_subjects
      - get_wb_brands
      - search_wb_products

  # Wildberries Dictionaries — справочники WB
  wb-dictionaries-tools:
    description: "Wildberries Dictionaries: countries, characteristics, TNVED, colors"
    tools:
      - wb_countries
      - wb_colors
      - wb_genders
      - wb_seasons
      - wb_vat_rates

# Включаем только нужные bundles
enable_bundles:
  - wb-content-tools

# ===== PHASE 3: Token Resolution Mode =====
# bundle-first — LLM видит только bundles (экономия 75-95% токенов)
tool_resolution_mode: "bundle-first"

# Chains Configuration
chains:
  default:
    max_iterations: 10
    interruption_prompt: "interruption_handler.yaml"

# ===== Wildberries API Configuration =====
wb:
  api_key: "${WB_API_KEY}"
  timeout: "30s"
  default_rate_limit: 60  # запросов в минуту

# Tools Configuration (индивидуальные override если нужно)
tools:
  # Content API инструменты
  get_wb_parent_categories:
    enabled: true
    endpoint: "https://content-api.wildberries.ru"
    rate_limit: 100

  get_wb_subjects:
    enabled: true
    endpoint: "https://content-api.wildberries.ru"
    rate_limit: 60

  get_wb_brands:
    enabled: true
    endpoint: "https://content-api.wildberries.ru"
    rate_limit: 60

  search_wb_products:
    enabled: true
    endpoint: "https://content-api.wildberries.ru"
    rate_limit: 60

  # Dictionaries (отключены для этого примера)
  wb_countries:
    enabled: false
  wb_colors:
    enabled: false
  wb_genders:
    enabled: false
  wb_seasons:
    enabled: false
  wb_vat_rates:
    enabled: false
